CREATE TABLE matches (
    id INT PRIMARY KEY,
    country_id INT,
    season VARCHAR(50),
    stage INT,
    date DATE,
    hometeam_id INT,
    awayteam_id INT,
    home_goal INT,
    away_goal INT
);

INSERT INTO matches (id, country_id, season, stage, date, hometeam_id, awayteam_id, home_goal, away_goal)
VALUES
(1237, 1, '2013/2014', 1, '2014-03-29', 8475, 9989, 2, 0),
(1238, 1, '2013/2014', 1, '2014-03-29', 9991, 8573, 0, 1),
(1239, 1, '2013/2014', 2, '2014-04-05', 9989, 9991, 1, 0),
(1240, 1, '2013/2014', 2, '2014-04-05', 8573, 8475, 0, 0),
(1241, 1, '2013/2014', 3, '2014-04-12', 9991, 8475, 2, 1),
(1242, 1, '2013/2014', 3, '2014-04-12', 8573, 9989, 2, 0),
(1243, 1, '2013/2014', 4, '2014-04-19', 8475, 9991, 2, 4),
(1244, 1, '2013/2014', 4, '2014-04-19', 9989, 8573, 0, 2),
(1245, 1, '2013/2014', 5, '2014-04-26', 9989, 8475, 4, 2),
(1246, 1, '2013/2014', 5, '2014-04-26', 8573, 9991, 1, 1),
(1247, 1, '2013/2014', 6, '2014-05-03', 8475, 8573, 0, 1),
(1248, 1, '2013/2014', 6, '2014-05-03', 9991, 9989, 4, 0),
(1249, 1, '2014/2015', 1, '2014-07-25', 9985, 9986, 3, 0),
(1250, 1, '2014/2015', 1, '2014-07-26', 8475, 8342, 0, 2),
(1251, 1, '2014/2015', 1, '2014-07-26', 9984, 9991, 0, 0),
(1252, 1, '2014/2015', 1, '2014-07-26', 9989, 8573, 2, 0),
(1253, 1, '2014/2015', 1, '2014-07-26', 10001, 9994, 1, 0),
(1254, 1, '2014/2015', 1, '2014-07-27', 8203, 9987, 3, 1),
(1255, 1, '2014/2015', 1, '2014-07-27', 8635, 274581, 3, 1),
(1256, 1, '2014/2015', 1, '2014-07-27', 10000, 8571, 2, 0),
(1257, 1, '2014/2015', 10, '2014-10-05', 8342, 9985, 3, 0),
(1258, 1, '2014/2015', 10, '2014-10-05', 8635, 9987, 0, 0),
(1259, 1, '2014/2015', 10, '2014-10-04', 9986, 8571, 0, 2),
(1260, 1, '2014/2015', 10, '2014-10-04', 274581, 8203, 1, 1),
(1261, 1, '2014/2015', 10, '2014-10-05', 9994, 8573, 3, 1),
(1262, 1, '2014/2015', 10, '2014-10-04', 9989, 10000, 3, 1),
(1263, 1, '2014/2015', 10, '2014-10-03', 10001, 9991, 0, 0),
(1264, 1, '2014/2015', 10, '2014-10-04', 8475, 9984, 1, 0),
(1265, 1, '2014/2015', 11, '2014-10-19', 9985, 10000, 1, 2),
(1266, 1, '2014/2015', 11, '2014-10-19', 9987, 10001, 3, 1),
(1267, 1, '2014/2015', 11, '2014-10-18', 9991, 9986, 2, 2),
(1268, 1, '2014/2015', 11, '2014-10-18', 8573, 274581, 0, 0),
(1269, 1, '2014/2015', 11, '2014-10-19', 9994, 8342, 1, 3),
(1270, 1, '2014/2015', 11, '2014-10-18', 8571, 8475, 2, 1),
(1271, 1, '2014/2015', 11, '2014-10-18', 8203, 8635, 1, 1),
(1272, 1, '2014/2015', 11, '2014-10-18', 9984, 9989, 1, 2),
(1273, 1, '2014/2015', 12, '2014-10-26', 8342, 9991, 2, 2),
(1274, 1, '2014/2015', 12, '2014-10-26', 8635, 9985, 0, 2),
(1275, 1, '2014/2015', 12, '2014-10-25', 9986, 8573, 2, 0),
(1276, 1, '2014/2015', 12, '2014-10-25', 10000, 9984, 1, 2),
(1277, 1, '2014/2015', 12, '2014-10-26', 274581, 9994, 2, 2),
(1278, 1, '2014/2015', 12, '2014-10-24', 9989, 8203, 0, 1),
(1279, 1, '2014/2015', 12, '2014-10-25', 10001, 8571, 2, 1),
(1280, 1, '2014/2015', 12, '2014-10-25', 8475, 9987, 0, 1),
(1281, 1, '2014/2015', 13, '2014-10-28', 9987, 9989, 3, 0),
(1282, 1, '2014/2015', 13, '2014-10-29', 9991, 8475, 4, 1),
(1283, 1, '2014/2015', 13, '2014-10-29', 8573, 10001, 4, 0),
(1284, 1, '2014/2015', 13, '2014-10-30', 274581, 8342, 1, 4),
(1285, 1, '2014/2015', 13, '2014-10-29', 9994, 9986, 5, 2),
(1286, 1, '2014/2015', 13, '2014-10-29', 8571, 8635, 2, 3),
(1287, 1, '2014/2015', 13, '2014-10-28', 8203, 10000, 1, 1),
(1288, 1, '2014/2015', 13, '2014-10-29', 9984, 9985, 0, 1),
(1289, 1, '2014/2015', 14, '2014-11-01', 8635, 9994, 1, 1),
(1290, 1, '2014/2015', 14, '2014-11-01', 9985, 8203, 2, 0),
(1291, 1, '2014/2015', 14, '2014-11-02', 9986, 8342, 0, 0),
(1292, 1, '2014/2015', 14, '2014-10-31', 10000, 9987, 2, 0),
(1293, 1, '2014/2015', 14, '2014-11-02', 9989, 9991, 0, 1),
(1294, 1, '2014/2015', 14, '2014-11-02', 10001, 274581, 1, 3),
(1295, 1, '2014/2015', 14, '2014-11-01', 8475, 8573, 1, 0),
(1296, 1, '2014/2015', 14, '2014-11-01', 9984, 8571, 0, 4),
(1297, 1, '2014/2015', 15, '2014-11-09', 8342, 10001, 5, 0),
(1298, 1, '2014/2015', 15, '2014-11-09', 9987, 9985, 0, 2),
(1299, 1, '2014/2015', 15, '2014-11-09', 9991, 8635, 0, 2),
(1300, 1, '2014/2015', 15, '2014-11-07', 8573, 10000, 1, 3),
(1301, 1, '2014/2015', 15, '2014-11-08', 274581, 9986, 0, 2),
(1302, 1, '2014/2015', 15, '2014-11-08', 8571, 8475, 3, 0),
(1303, 1, '2014/2015', 15, '2014-11-08', 8203, 9984, 1, 1),
(1304, 1, '2014/2015', 15, '2014-11-08', 9984, 9989, 1, 2),
(1305, 1, '2014/2015', 16, '2014-11-22', 274581, 9989, 2, 1),
(1306, 1, '2014/2015', 16, '2014-11-22', 9994, 10001, 0, 0),
(1307, 1, '2014/2015', 16, '2014-11-23', 8571, 10000, 3, 1),
(1308, 1, '2014/2015', 16, '2014-11-22', 8342, 8475, 4, 2),
(1309, 1, '2014/2015', 16, '2014-11-23', 9987, 8203, 3, 0),
(1310, 1, '2014/2015', 16, '2014-11-22', 9991, 9984, 4, 0),
(1311, 1, '2014/2015', 16, '2014-11-23', 8573, 9985, 3, 2),
(1312, 1, '2014/2015', 16, '2014-11-22', 9986, 8635, 3, 1),
(1313, 1, '2014/2015', 17, '2014-11-30', 8635, 8342, 2, 2),
(1314, 1, '2014/2015', 17, '2014-11-30', 9985, 8571, 0, 2),
(1315, 1, '2014/2015', 17, '2014-11-28', 10000, 9991, 2, 1),
(1316, 1, '2014/2015', 17, '2014-11-29', 8203, 8573, 0, 0),
(1317, 1, '2014/2015', 17, '2014-11-30', 9989, 9994, 1, 1),
(1318, 1, '2014/2015', 17, '2014-11-29', 10001, 9986, 2, 3),
(1319, 1, '2014/2015', 17, '2014-11-29', 8475, 274581, 2, 1),
(1320, 1, '2014/2015', 17, '2014-11-29', 9984, 9987, 0, 1),
(1321, 1, '2014/2015', 18, '2014-12-07', 8342, 10000, 2, 1),
(1322, 1, '2014/2015', 18, '2014-12-07', 9991, 9987, 0, 0),
(1323, 1, '2014/2015', 18, '2014-12-06', 8573, 9989, 2, 1),
(1324, 1, '2014/2015', 18, '2014-12-07', 9986, 9985, 0, 1),
(1325, 1, '2014/2015', 18, '2014-12-06', 274581, 8635, 4, 2),
(1326, 1, '2014/2015', 18, '2014-12-06', 9994, 9984, 0, 0),
(1327, 1, '2014/2015', 18, '2014-12-06', 8571, 8203, 3, 0),
(1328, 1, '2014/2015', 18, '2014-12-05', 10001, 8475, 1, 2),
(1329, 1, '2014/2015', 19, '2014-12-14', 8635, 8573, 3, 0),
(1330, 1, '2014/2015', 19, '2014-12-14', 9985, 8342, 1, 3),
(1331, 1, '2014/2015', 19, '2014-12-13', 9987, 8571, 3, 0),
(1332, 1, '2014/2015', 19, '2014-12-14', 10000, 9994, 1, 0),
(1333, 1, '2014/2015', 19, '2014-12-12', 8203, 9991, 0, 0),
(1334, 1, '2014/2015', 19, '2014-12-13', 9989, 10001, 3, 3),
(1335, 1, '2014/2015', 19, '2014-12-13', 8475, 9986, 1, 3),
(1336, 1, '2014/2015', 19, '2014-12-13', 9984, 274581, 2, 1);

select * from matches;
-- How many matches ended in a draw (home_goal = away_goal) in the 2013/2014 season?
select 
sum(case when home_goal = away_goal then 1 else 0 end) as draw_matches
from matches
where season = '2013/2014';

-- How many matches did team with ID 8475 win as the home team in the 2013/2014 season?
select sum(case when home_goal > away_goal then 1 else 0 end) as home_wins
from matches
where hometeam_id = 8475 and season = '2013/2014'; 

-- What is the total number of goals scored by the home team in matches where the 
-- away team scored more than 2 goals in the 2013/2014 season?
select sum(home_goal) as sum_home_goal
from matches
where away_goal > 2 and season = '2013/2014';

-- How many matches in the 2014/2015 season had a combined total of goals 
-- (home_goal + away_goal) greater than 5

select count(id) as goals_more_than_five
from matches
where season = '2014/2015' and (home_goal + away_goal) > 5;


-- How many matches in the 2014/2015 season had a combined total of goals (home_goal + away_goal) less than 3?
select count(*) as less_scoring_games
from matches
where season = '2014/2015' and (home_goal + away_goal) < 3;

-- How many matches in the 2014/2015 season ended in a draw where both teams scored more than 1 goal each?

select count(*) as high_score_draws from
matches 
where season = '2014/2015' and home_goal = away_goal and home_goal > 1;
